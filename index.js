document.addEventListener('DOMContentLoaded', function () {

    // wait 15 seconds, reset timer if user clicks away
    window.addEventListener('blur', clickAway);
    window.addEventListener('focus', startCountdown);

    var countdownTimeout;
    var countdownDuration = 10000;

    function startCountdown() {
        var startTime = Date.now();

        function updateCountdown() {
            if (Date.now() - startTime < countdownDuration) {
                countdownTimeout = setTimeout(updateCountdown, 1000);
            } else {
                countdownFinished();
            }
        }
        updateCountdown();
    }

    function clickAway() {
        clearTimeout(countdownTimeout);
    }

    function countdownFinished() {
        window.removeEventListener('blur', clickAway);
        window.removeEventListener('focus', startCountdown);

        countdownText.textContent = '5';
        setTimeout(textCountdown, 1000);
    }

    // show a countdown from 5
    var countdownText = document.getElementById('countdown');
    var overlay = document.getElementById('overlay');

    function textCountdown() {
        var currentCount = parseInt(countdownText.textContent);

        if (currentCount > 0) {
            countdownText.textContent = (currentCount - 1).toString();
            setTimeout(textCountdown, 1000);
        } else {
            // switch to 'chromatic verity.'
            document.getElementById('main-content').style.display = 'none';
            document.getElementById('super').style.display = 'inherit';
            document.body.style.backgroundColor = '#121212';
            updateColor();
            setTimeout(function () {
                overlay.style.backgroundColor = '#12121200';
            }, 500);
            setTimeout(function () {
                overlay.style.display = 'none';
            }, 2000);
        }
    }

    var cycle = 0;
    var hue = 0;

    // cycle the hue every 4 frames
    function colorIncrement() {
        cycle = (cycle + 1) % 4;
        if (cycle == 0) {
            hue = (hue + 1) % 360;
        }
        return superColors[hue];
    }

    function updateColor() {
        document.documentElement.style.setProperty('--super-color', colorIncrement());
        requestAnimationFrame(updateColor);
    }

    startCountdown();
});

const superColors = [
    '#ffa3a3',
    '#ffa3a1',
    '#ffa39f',
    '#ffa49f',
    '#ffa49d',
    '#ffa49b',
    '#ffa499',
    '#ffa497',
    '#ffa597',
    '#ffa493',
    '#ffa593',
    '#ffa48f',
    '#ffa48d',
    '#ffa48b',
    '#ffa68b',
    '#ffa587',
    '#ffa685',
    '#ffa683',
    '#ffa680',
    '#ffa57c',
    '#ffa578',
    '#ffa778',
    '#ffa774',
    '#ffa770',
    '#ffa76c',
    '#ffa768',
    '#ffa764',
    '#ffa760',
    '#ffa85c',
    '#ffa958',
    '#ffa954',
    '#ffa84c',
    '#ffa948',
    '#ffa940',
    '#ffa938',
    '#ffa930',
    '#ffa928',
    '#ffa920',
    '#ffaa18',
    '#ffab10',
    '#ffaa00',
    '#fbac00',
    '#f7ad00',
    '#f5b000',
    '#f1b100',
    '#edb200',
    '#ebb400',
    '#e7b500',
    '#e3b600',
    '#e1b800',
    '#ddb800',
    '#dbba00',
    '#d7ba00',
    '#d5bc00',
    '#d1bc00',
    '#cfbe00',
    '#cbbe00',
    '#c9bf00',
    '#c7c100',
    '#c5c200',
    '#c2c200',
    '#c0c300',
    '#bdc300',
    '#bbc500',
    '#b8c500',
    '#b5c500',
    '#b3c700',
    '#b0c700',
    '#adc700',
    '#abc900',
    '#a8c900',
    '#a4c900',
    '#a3cb00',
    '#9fcb00',
    '#9ccb00',
    '#99cc00',
    '#96cd00',
    '#93cd00',
    '#90cd00',
    '#8ecf00',
    '#8acf00',
    '#87cf00',
    '#84d000',
    '#81d100',
    '#7ed100',
    '#7ad100',
    '#77d100',
    '#74d300',
    '#71d300',
    '#6dd300',
    '#6ad300',
    '#67d500',
    '#63d500',
    '#60d500',
    '#5cd500',
    '#59d500',
    '#55d500',
    '#52d700',
    '#4fd700',
    '#4bd700',
    '#48d700',
    '#44d700',
    '#41d700',
    '#3dd700',
    '#3ad800',
    '#36d900',
    '#33d900',
    '#2fd900',
    '#2bd900',
    '#28d900',
    '#24d900',
    '#21d900',
    '#1dd900',
    '#19d900',
    '#16d900',
    '#12d900',
    '#0ed900',
    '#0bd900',
    '#07d900',
    '#04d900',
    '#00d900',
    '#00d904',
    '#00d907',
    '#00d90b',
    '#00d90e',
    '#00d912',
    '#00d916',
    '#00d919',
    '#00d91d',
    '#00d921',
    '#00d924',
    '#00d928',
    '#00d92b',
    '#00d92f',
    '#00d933',
    '#00d936',
    '#00d93a',
    '#00d93e',
    '#00d941',
    '#00d945',
    '#00d948',
    '#00d94c',
    '#00d950',
    '#00d953',
    '#00d957',
    '#00d95a',
    '#00d95e',
    '#00d861',
    '#00d764',
    '#00d768',
    '#00d76c',
    '#00d76f',
    '#00d773',
    '#00d776',
    '#00d77a',
    '#00d77e',
    '#00d781',
    '#00d785',
    '#00d788',
    '#00d78c',
    '#00d58e',
    '#00d592',
    '#00d595',
    '#00d599',
    '#00d59c',
    '#00d5a0',
    '#00d5a3',
    '#00d5a7',
    '#00d4aa',
    '#00d3ac',
    '#00d3b0',
    '#00d3b4',
    '#00d3b7',
    '#00d3bb',
    '#00d3be',
    '#00d3c2',
    '#00d1c3',
    '#00d1c7',
    '#00d1ca',
    '#00d1ce',
    '#00d1d1',
    '#00d0d3',
    '#00d0d7',
    '#00d0db',
    '#00d0df',
    '#00cee1',
    '#00cee5',
    '#00cee9',
    '#00cded',
    '#00cdf1',
    '#00ccf5',
    '#00cbf9',
    '#00ccff',
    '#10cbff',
    '#20cbff',
    '#2ccaff',
    '#38caff',
    '#40c9ff',
    '#48c8ff',
    '#50c7ff',
    '#58c7ff',
    '#5cc6ff',
    '#60c5ff',
    '#68c5ff',
    '#6cc4ff',
    '#70c3ff',
    '#74c3ff',
    '#78c2ff',
    '#7cc2ff',
    '#80c1ff',
    '#83c1ff',
    '#85c0ff',
    '#87bfff',
    '#8bbfff',
    '#8bbeff',
    '#8fbeff',
    '#93beff',
    '#93bdff',
    '#97bdff',
    '#97bcff',
    '#99bbff',
    '#9bbbff',
    '#9dbbff',
    '#9fbaff',
    '#a1baff',
    '#a3baff',
    '#a3b9ff',
    '#a5b9ff',
    '#a7b9ff',
    '#a9b9ff',
    '#a9b8ff',
    '#abb8ff',
    '#adb8ff',
    '#adb7ff',
    '#afb7ff',
    '#afb6ff',
    '#b1b7ff',
    '#b1b5ff',
    '#b3b6ff',
    '#b3b5ff',
    '#b5b5ff',
    '#b7b5ff',
    '#b8b5ff',
    '#b7b3ff',
    '#b8b3ff',
    '#bab3ff',
    '#bbb3ff',
    '#bcb3ff',
    '#bdb3ff',
    '#beb2ff',
    '#beb1ff',
    '#c0b1ff',
    '#c1b1ff',
    '#c2b1ff',
    '#c3b1ff',
    '#c4b0ff',
    '#c5afff',
    '#c6afff',
    '#c7afff',
    '#c9afff',
    '#caafff',
    '#caadff',
    '#cbadff',
    '#cdadff',
    '#ceadff',
    '#cfadff',
    '#d0abff',
    '#d1abff',
    '#d2abff',
    '#d4abff',
    '#d5abff',
    '#d6a9ff',
    '#d7a9ff',
    '#d8a9ff',
    '#d9a7ff',
    '#daa7ff',
    '#dca7ff',
    '#dda7ff',
    '#dea5ff',
    '#e0a5ff',
    '#e1a5ff',
    '#e2a3ff',
    '#e4a3ff',
    '#e5a3ff',
    '#e7a3ff',
    '#e8a1ff',
    '#e9a1ff',
    '#ea9fff',
    '#ec9fff',
    '#ed9fff',
    '#ef9fff',
    '#f09dff',
    '#f29bff',
    '#f39bff',
    '#f59bff',
    '#f79bff',
    '#f899ff',
    '#fa97ff',
    '#fc97ff',
    '#fd97ff',
    '#ff95ff',
    '#ff97fd',
    '#ff97fc',
    '#ff97fa',
    '#ff97f8',
    '#ff97f6',
    '#ff97f5',
    '#ff97f3',
    '#ff97f1',
    '#ff97ef',
    '#ff97ee',
    '#ff99ec',
    '#ff99eb',
    '#ff99e9',
    '#ff99e7',
    '#ff9be6',
    '#ff9be4',
    '#ff9be3',
    '#ff9be1',
    '#ff9bdf',
    '#ff9bde',
    '#ff9bdc',
    '#ff9bda',
    '#ff9bd9',
    '#ff9bd7',
    '#ff9bd5',
    '#ff9dd5',
    '#ff9dd3',
    '#ff9dd1',
    '#ff9dd0',
    '#ff9dce',
    '#ff9dcd',
    '#ff9fcc',
    '#ff9fca',
    '#ff9fc9',
    '#ff9fc7',
    '#ff9fc6',
    '#ff9fc4',
    '#ff9fc2',
    '#ff9fc1',
    '#ff9fbf',
    '#ff9fbe',
    '#ff9fbc',
    '#ff9fba',
    '#ff9fb9',
    '#ffa1b9',
    '#ffa1b7',
    '#ffa1b6',
    '#ffa1b4',
    '#ffa1b3',
    '#ffa1b1',
    '#ffa1af',
    '#ffa1ae',
    '#ffa1ac',
    '#ffa3ad',
    '#ffa3ab',
    '#ffa3a9',
    '#ffa3a8',
    '#ffa3a6',
    '#ffa3a5',
];
